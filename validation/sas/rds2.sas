DATA pkdata;
infile datalines dlm="," truncover;
input subject $ formulation $ period $sequence $ var;
datalines;
1,T,1,TRRT,0.1624021955274546
1,R,2,TRRT,-0.693899926584133
1,R,3,TRRT,-0.010802640253512186
1,T,4,TRRT,0.6022905335476663
2,T,1,TRRT,-0.2927518225313457
2,R,2,TRRT,0.9438494607677548
2,R,3,TRRT,0.11519510864587357
2,T,4,TRRT,-0.7171646220304551
3,T,1,TRRT,1.8665289284994468
3,R,2,TRRT,1.0827912009986624
3,R,3,TRRT,1.7640635528166067
3,T,4,TRRT,2.9680265742669283
4,T,1,TRRT,2.4037618483922882
4,R,2,TRRT,2.3553465543928556
4,R,3,TRRT,2.3528534536963166
4,T,4,TRRT,2.509542366493875
5,T,1,TRRT,0.7592077658183507
5,R,2,TRRT,0.95781272475653
5,R,3,TRRT,1.4518367665391945
5,T,4,TRRT,0.9250025226285912
6,T,1,TRRT,1.6352123467590278
6,R,2,TRRT,0.23505221802961462
6,R,3,TRRT,2.0219344211910766
6,T,4,TRRT,1.960821735488765
7,T,1,TRRT,-0.11200143474454638
7,R,2,TRRT,0.5104836777286972
7,R,3,TRRT,0.2385446171892095
7,T,4,TRRT,-0.07645025734694455
8,T,1,TRRT,0.12860180833965962
8,R,2,TRRT,-0.25307806457863347
8,R,3,TRRT,-1.0012092490616857
8,T,4,TRRT,-0.3260186837021719
9,T,1,TRRT,-0.1483797584386588
9,R,2,TRRT,0.5573468191858084
9,R,3,TRRT,-0.4475413856760684
9,T,4,TRRT,0.2980235016471211
10,T,1,TRRT,1.0859911697622437
10,R,2,TRRT,0.4778992360670803
10,R,3,TRRT,0.6615473003004679
10,T,4,TRRT,1.1863715814904487
11,T,1,TRRT,2.7920897310606883
11,R,2,TRRT,2.4547964700994425
11,R,3,TRRT,2.6926359288229627
11,T,4,TRRT,2.0873087374167274
12,T,1,TRRT,1.1926395823474176
12,R,2,TRRT,1.47954360806537
12,R,3,TRRT,0.21111439970777102
12,T,4,TRRT,0.8718571249902307
13,R,1,RTTR,0.5226552962463996
13,T,2,RTTR,0.31651831406957665
13,T,3,RTTR,0.6585658386868717
13,R,4,RTTR,0.0518924844763472
14,R,1,RTTR,0.7848087506736419
14,T,2,RTTR,0.3743475885162333
14,T,3,RTTR,0.6555980566942063
14,R,4,RTTR,0.1013163100404274
15,R,1,RTTR,0.6734799955839013
15,T,2,RTTR,1.1718583379276588
15,T,3,RTTR,1.619909462085431
15,R,4,RTTR,0.5314709581316305
16,R,1,RTTR,0.979744958435559
16,T,2,RTTR,0.21910084961583887
16,T,3,RTTR,0.5664308658924642
16,R,4,RTTR,1.879228636890213
17,R,1,RTTR,2.4565756601300404
17,T,2,RTTR,2.821129205090829
17,T,3,RTTR,2.337080219913501
17,R,4,RTTR,2.669766908662144
18,R,1,RTTR,2.1417337858834777
18,T,2,RTTR,3.0182048308537235
18,T,3,RTTR,2.4255684223043175
18,R,4,RTTR,2.976518145706753
19,R,1,RTTR,2.0866586550731783
19,T,2,RTTR,1.5009409508369924
19,T,3,RTTR,1.1596157614282727
19,R,4,RTTR,1.3903064242469982
20,R,1,RTTR,1.9605168307271261
20,T,2,RTTR,1.5317051585080343
20,T,3,RTTR,2.2234524736845804
20,R,4,RTTR,2.631277229187772
21,R,1,RTTR,1.5043199839734491
21,T,2,RTTR,1.026776328245452
21,T,3,RTTR,1.7226395753476451
21,R,4,RTTR,0.9201002477273348
22,R,1,RTTR,-0.6682050407309812
22,T,2,RTTR,-0.3954176001544816
22,T,3,RTTR,-0.32639437864248033
22,R,4,RTTR,0.14198917983403014
23,R,1,RTTR,0.26215383879945586
23,T,2,RTTR,0.5060116302434031
23,T,3,RTTR,0.21679168733781917
23,R,4,RTTR,0.006267330459341025
24,R,1,RTTR,-0.5247300470266449
24,T,2,RTTR,-0.48572861633079434
24,T,3,RTTR,-0.9396186978559333
24,R,4,RTTR,-0.493466092174794
;
RUN;

PROC MIXED data=pkdata; 
CLASSES subject sequence period formulation;
MODEL  var = sequence period formulation/ DDFM=SATTERTH;
CONTRAST 'CONTR' formulation    1 -1; 
RANDOM  formulation/TYPE=CSH SUB=subject;
REPEATED/GRP=formulation SUB=subject;
ESTIMATE 'T vs. R' formulation 1 -1/CL ALPHA=0.1 E;
RUN;