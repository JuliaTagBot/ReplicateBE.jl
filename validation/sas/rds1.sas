DATA pkdata;
infile datalines dlm="," truncover;
input subject $ formulation $ period $sequence $ var;
datalines;
1,T,1,TRTR,0.5650056131192267
1,R,2,TRTR,0.2829900442386539
1,T,3,TRTR,0.055751451774515015
1,R,4,TRTR,0.13573218629336703
2,T,1,TRTR,1.7146619110435641
2,R,2,TRTR,0.8541952087574829
2,T,3,TRTR,2.096311123507042
2,R,4,TRTR,1.1623203353977267
3,T,1,TRTR,0.9376312718166401
3,R,2,TRTR,0.43334879333977416
3,T,3,TRTR,1.0808905724157396
3,R,4,TRTR,0.9990706790117321
4,T,1,TRTR,1.6317194286686516
4,R,2,TRTR,1.6464140486152448
4,T,3,TRTR,1.337603862702703
4,R,4,TRTR,1.4163283599239238
5,T,1,TRTR,1.5887600180859305
5,R,2,TRTR,1.7931730108632917
5,T,3,TRTR,2.0834130069620507
5,R,4,TRTR,0.7738794579313147
6,T,1,TRTR,1.9956023019277853
6,R,2,TRTR,2.1471419373805793
6,T,3,TRTR,1.9896989041037116
6,R,4,TRTR,1.1775584013651992
7,T,1,TRTR,0.19322338802496009
7,R,2,TRTR,0.47386695391680067
7,T,3,TRTR,0.4935879864972722
7,R,4,TRTR,0.429941659697746
8,T,1,TRTR,1.3300352752904707
8,R,2,TRTR,1.8915026105089723
8,T,3,TRTR,1.1148753968390261
8,R,4,TRTR,1.6348580382098499
9,T,1,TRTR,1.0768684299247726
9,R,2,TRTR,2.310201893850061
9,T,3,TRTR,1.9602072275582012
9,R,4,TRTR,1.6792328856393228
10,T,1,TRTR,1.1515079310816505
10,R,2,TRTR,1.8715761196067016
10,T,3,TRTR,1.0208497020005476
10,R,4,TRTR,1.5705193529536272
11,T,1,TRTR,1.7131636461831392
11,R,2,TRTR,1.3740739736966499
11,T,3,TRTR,1.3511567263037143
11,R,4,TRTR,1.2759340406882478
12,T,1,TRTR,-0.5730751354396562
12,R,2,TRTR,0.6947615802103331
12,T,3,TRTR,-0.3341993152083431
12,R,4,TRTR,0.8353635907238621
13,R,1,RTRT,1.4798554214774977
13,T,2,RTRT,1.632541739117829
13,R,3,RTRT,2.2453415998240667
13,T,4,RTRT,1.659580062676875
14,R,1,RTRT,2.194642342757322
14,T,2,RTRT,2.101474989017964
14,R,3,RTRT,2.1417250267513226
14,T,4,RTRT,1.8261517239979528
15,R,1,RTRT,0.23644967094486768
15,T,2,RTRT,1.1161294795214118
15,R,3,RTRT,1.2642024432362324
15,T,4,RTRT,0.7468047917172812
16,R,1,RTRT,1.5186709913024998
16,T,2,RTRT,1.179691181544939
16,R,3,RTRT,1.2526582679118274
16,T,4,RTRT,1.5255276183909166
17,R,1,RTRT,0.9142336389440733
17,T,2,RTRT,0.9923416265601894
17,R,3,RTRT,0.2324966426204561
17,T,4,RTRT,0.7688371677652873
18,R,1,RTRT,-0.5246524822733001
18,T,2,RTRT,1.1992921401193446
18,R,3,RTRT,0.5142268106337475
18,T,4,RTRT,1.2714787730491324
19,R,1,RTRT,2.1559672498903097
19,T,2,RTRT,2.163846009004949
19,R,3,RTRT,1.299896279133843
19,T,4,RTRT,1.8980118589600927
20,R,1,RTRT,2.7899896299355467
20,T,2,RTRT,1.354444792481369
20,R,3,RTRT,1.9512834297259003
20,T,4,RTRT,1.6145111303829516
21,R,1,RTRT,0.9929537668053166
21,T,2,RTRT,0.777979220694806
21,R,3,RTRT,0.38526682737729945
21,T,4,RTRT,0.689156877950978
22,R,1,RTRT,1.793955198179051
22,T,2,RTRT,1.845757700904017
22,R,3,RTRT,1.3259323165058938
22,T,4,RTRT,2.2829742156609343
23,R,1,RTRT,1.2663723062287153
23,T,2,RTRT,0.8107057257388243
23,R,3,RTRT,1.3898983890256642
23,T,4,RTRT,1.8511176333933583
24,R,1,RTRT,1.2034212533957735
24,T,2,RTRT,-0.3742646254609756
24,R,3,RTRT,0.6953635199408132
24,T,4,RTRT,0.2789677169897882
;
RUN;

PROC MIXED data=pkdata; 
CLASSES subject sequence period formulation;
MODEL  var = sequence period formulation/ DDFM=SATTERTH;
CONTRAST 'CONTR' formulation    1 -1; 
RANDOM  formulation/TYPE=CSH SUB=subject;
REPEATED/GRP=formulation SUB=subject;
ESTIMATE 'T vs. R' formulation 1 -1/CL ALPHA=0.1 E;
RUN;