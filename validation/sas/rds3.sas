DATA pkdata;
infile datalines dlm="," truncover;
input subject $ formulation $ period $sequence $ var;
datalines;
1,T,1,TTRR,0.3144995621312071
1,T,2,TTRR,0.09937040064699731
1,R,3,TTRR,0.09561734786036902
1,R,4,TTRR,0.5882849054424159
2,T,1,TTRR,2.155034596827911
2,T,2,TTRR,1.7115703522289085
2,R,3,TTRR,2.191669629622169
2,R,4,TTRR,1.6410120806827446
3,T,1,TTRR,2.1351749840524246
3,T,2,TTRR,2.275800310081853
3,R,3,TTRR,2.2331046245786386
3,R,4,TTRR,2.2155468314421407
4,T,1,TTRR,1.653362421702889
4,T,2,TTRR,1.2843941448602172
4,R,3,TTRR,0.7165249041190375
4,R,4,TTRR,1.5346925800233602
5,T,1,TTRR,0.38294880631382544
5,T,2,TTRR,1.3510822762947758
5,R,3,TTRR,1.1430097421827132
5,R,4,TTRR,1.069039476959792
6,T,1,TTRR,0.6512776211859252
6,T,2,TTRR,0.8711290245742734
6,R,3,TTRR,0.34786359415922086
6,R,4,TTRR,0.910023619595167
7,T,1,TTRR,1.7196538786482058
7,T,2,TTRR,1.85964474300543
7,R,3,TTRR,0.9441079678999219
7,R,4,TTRR,0.9251884765745749
8,T,1,TTRR,0.8121329733647036
8,T,2,TTRR,1.2584261925460098
8,R,3,TTRR,0.833595285685022
8,R,4,TTRR,0.9980858484715832
9,T,1,TTRR,1.0800295942019846
9,T,2,TTRR,2.181344801503432
9,R,3,TTRR,1.7423867292394482
9,R,4,TTRR,1.7040241716000089
10,T,1,TTRR,-1.3952208970367357
10,T,2,TTRR,-1.1412572474847638
10,R,3,TTRR,-0.5302500193258999
10,R,4,TTRR,-0.3736417016933915
11,T,1,TTRR,0.7012819914705657
11,T,2,TTRR,1.1240223236913292
11,R,3,TTRR,0.8373892262928129
11,R,4,TTRR,0.9738493693278913
12,T,1,TTRR,2.057285980039218
12,T,2,TTRR,2.026024429410089
12,R,3,TTRR,1.7974614591061342
12,R,4,TTRR,1.7353813002037553
13,R,1,RRTT,1.2629273090817226
13,R,2,RRTT,1.2977926318320545
13,T,3,RRTT,1.5875461379856082
13,T,4,RRTT,1.1314436497522182
14,R,1,RRTT,0.31000371913977365
14,R,2,RRTT,0.5934933807178184
14,T,3,RRTT,0.6217857185228542
14,T,4,RRTT,0.6323468737781377
15,R,1,RRTT,1.2967292281245515
15,R,2,RRTT,1.1941360382380808
15,T,3,RRTT,0.1409931116951112
15,T,4,RRTT,0.568614362870415
16,R,1,RRTT,2.6956931751466806
16,R,2,RRTT,1.517594424925508
16,T,3,RRTT,1.4007658487228638
16,T,4,RRTT,1.676010766434059
17,R,1,RRTT,0.7036600841373384
17,R,2,RRTT,0.11888307294507006
17,T,3,RRTT,0.16647825737747435
17,T,4,RRTT,-0.2275502302687602
18,R,1,RRTT,1.3783605126686784
18,R,2,RRTT,0.47369663223146175
18,T,3,RRTT,1.2379946630445986
18,T,4,RRTT,0.8482922983800483
19,R,1,RRTT,2.358200378249868
19,R,2,RRTT,2.01740749256661
19,T,3,RRTT,1.9510402086525684
19,T,4,RRTT,1.842068772050664
20,R,1,RRTT,1.5023677263956725
20,R,2,RRTT,0.7646468625129494
20,T,3,RRTT,1.099010626524484
20,T,4,RRTT,1.227393777035942
21,R,1,RRTT,0.3091427635703584
21,R,2,RRTT,0.9980950963230688
21,T,3,RRTT,1.1418868024573396
21,T,4,RRTT,1.6665921120874965
22,R,1,RRTT,0.8806915818194665
22,R,2,RRTT,0.44795801635997046
22,T,3,RRTT,-0.25444665590059046
22,T,4,RRTT,0.48846744789021845
23,R,1,RRTT,1.3673122106308775
23,R,2,RRTT,1.5482696433476986
23,T,3,RRTT,1.8224416476021512
23,T,4,RRTT,1.645539837869115
24,R,1,RRTT,1.1015054838098999
24,R,2,RRTT,1.297123623690011
24,T,3,RRTT,1.6417082546183965
24,T,4,RRTT,1.2591418583950857
;
RUN;

PROC MIXED data=pkdata; 
CLASSES subject sequence period formulation;
MODEL  var = sequence period formulation/ DDFM=SATTERTH;
CONTRAST 'CONTR' formulation    1 -1; 
RANDOM  formulation/TYPE=CSH SUB=subject;
REPEATED/GRP=formulation SUB=subject;
ESTIMATE 'T vs. R' formulation 1 -1/CL ALPHA=0.1 E;
RUN;