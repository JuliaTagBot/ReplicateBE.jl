DATA pkdata;
infile datalines dlm="," truncover;
input subject $ formulation $ period $sequence $ var;
datalines;
1,T,1,TRR,1.5887555378104965
1,R,2,TRR,1.4941356602779903
1,R,3,TRR,2.493927147147934
2,T,1,TRR,0.981584391456206
2,R,2,TRR,1.2254898158032403
2,R,3,TRR,1.5396385371846653
3,T,1,TRR,0.45067717789076445
3,R,2,TRR,-0.34585430690819097
3,R,3,TRR,-0.8346285223093286
4,T,1,TRR,1.0710553596294987
4,R,2,TRR,0.6961890057031044
4,R,3,TRR,0.6911613203114402
5,T,1,TRR,0.41903558282935094
5,R,2,TRR,0.4544326820697341
5,R,3,TRR,0.804838743570212
6,T,1,TRR,-0.554093964370898
6,R,2,TRR,0.3868370136890338
6,R,3,TRR,0.16999286678729641
7,T,1,TRR,0.6029138650961796
7,R,2,TRR,0.413841094998331
7,R,3,TRR,0.1492310041988021
8,T,1,TRR,0.4355060524987885
8,R,2,TRR,0.66413383320972
8,R,3,TRR,0.23826267731035333
9,T,1,TRR,0.5222133552604432
9,R,2,TRR,0.5513076406568957
9,R,3,TRR,-0.26624377002104604
10,T,1,TRR,2.680838450282014
10,R,2,TRR,2.0165899650991737
10,R,3,TRR,2.6161278009668005
11,T,1,TRR,2.396317323654381
11,R,2,TRR,1.5998594471415983
11,R,3,TRR,1.2452182813458188
12,T,1,TRR,0.8478684348657592
12,R,2,TRR,0.9242312872170515
12,R,3,TRR,0.708515661515827
13,R,1,RTR,0.890343145947132
13,T,2,RTR,0.3704262619898133
13,R,3,RTR,0.3629659509057487
14,R,1,RTR,0.9279013904546594
14,T,2,RTR,1.0714536844346425
14,R,3,RTR,2.0801782149301413
15,R,1,RTR,0.7743950919488158
15,T,2,RTR,1.176093374597345
15,R,3,RTR,1.3049909931025874
16,R,1,RTR,0.6450927088542985
16,T,2,RTR,0.823538098897117
16,R,3,RTR,0.6002375812324947
17,R,1,RTR,-0.06671183189558505
17,T,2,RTR,0.8615659731446206
17,R,3,RTR,0.8141465692149649
18,R,1,RTR,1.532038061118683
18,T,2,RTR,1.1406852466662136
18,R,3,RTR,1.1247529059816546
19,R,1,RTR,1.2672581959192886
19,T,2,RTR,0.785770559063733
19,R,3,RTR,1.0779999257536865
20,R,1,RTR,1.4503469293152174
20,T,2,RTR,0.7703615430403032
20,R,3,RTR,0.6880399236698251
21,R,1,RTR,-0.30690604960715473
21,T,2,RTR,-0.008586284549122691
21,R,3,RTR,0.06020988196211907
22,R,1,RTR,1.0663941583782346
22,T,2,RTR,1.243280288846275
22,R,3,RTR,1.4077416298871435
23,R,1,RTR,-0.7153692429026761
23,T,2,RTR,-0.7897802077517713
23,R,3,RTR,0.21375913870252272
24,R,1,RTR,0.0446710108831907
24,T,2,RTR,-0.14739541099530795
24,R,3,RTR,0.23160967530402166
;
RUN;

PROC MIXED data=pkdata; 
CLASSES subject sequence period formulation;
MODEL  var = sequence period formulation/ DDFM=SATTERTH;
CONTRAST 'CONTR' formulation    1 -1; 
RANDOM  formulation/TYPE=CSH SUB=subject;
REPEATED/GRP=formulation SUB=subject;
ESTIMATE 'T vs. R' formulation 1 -1/CL ALPHA=0.1 E;
RUN;