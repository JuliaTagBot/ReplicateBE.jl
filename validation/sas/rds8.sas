DATA pkdata;
infile datalines dlm="," truncover;
input subject $ formulation $ period $sequence $ var;
datalines;
1,T,1,TRR,1.748462993253923
1,R,2,TRR,1.7159821792089955
1,R,3,TRR,1.7741368255676262
2,T,1,TRR,1.085403161213822
2,R,2,TRR,1.1574509536171558
2,R,3,TRR,2.1374320767475963
3,T,1,TRR,0.10180333018409993
3,R,2,TRR,0.24879033840737885
3,R,3,TRR,0.2885213206241214
4,T,1,TRR,0.18416713421330544
4,R,2,TRR,1.0041476520708943
4,R,3,TRR,-0.020583250201396952
5,T,1,TRR,0.5000942132848316
5,R,2,TRR,1.02807670568192
5,R,3,TRR,0.8772742586371128
6,T,1,TRR,0.0597532319028764
6,R,2,TRR,0.01862989804609061
6,R,3,TRR,-0.07915986215313797
7,T,1,TRR,-0.29708884003362046
7,R,2,TRR,-0.8513644575645145
7,R,3,TRR,0.08919391641106122
8,T,1,TRR,0.6399020556204984
8,R,2,TRR,0.605196298985299
8,R,3,TRR,0.22617541053145085
9,T,1,TRR,1.4890580601028292
9,R,2,TRR,1.2252645865668745
9,R,3,TRR,1.6970438813079727
10,T,1,TRR,1.199816578178687
10,R,2,TRR,1.4225319238743805
10,R,3,TRR,0.43527157645270276
11,T,1,TRR,0.3729086215730425
11,R,2,TRR,-0.1174188810893555
11,R,3,TRR,-0.32884978408533794
12,T,1,TRR,1.2039674029760685
12,R,2,TRR,0.6190703611111389
12,R,3,TRR,1.538857145495696
13,R,1,RTT,0.6993369830190387
13,T,2,RTT,1.4685176694800193
13,T,3,RTT,1.435878365349849
14,R,1,RTT,0.9707495034278831
14,T,2,RTT,1.365444931753673
14,T,3,RTT,1.5990980453708625
15,R,1,RTT,2.196442563407252
15,T,2,RTT,1.4548081622283808
15,T,3,RTT,1.7257380644733893
16,R,1,RTT,2.3800614072286823
16,T,2,RTT,1.138795392827772
16,T,3,RTT,1.4086683889052807
17,R,1,RTT,1.1140946875406361
17,T,2,RTT,0.5217173664036973
17,T,3,RTT,1.250394036216764
18,R,1,RTT,0.41399274066900404
18,T,2,RTT,0.9520528432494267
18,T,3,RTT,1.3659657098161808
19,R,1,RTT,0.33533572229003294
19,T,2,RTT,-0.1864132997785526
19,T,3,RTT,0.08048909857433184
20,R,1,RTT,-0.800475545828907
20,T,2,RTT,-0.07114791731543968
20,T,3,RTT,-0.08038386183097646
21,R,1,RTT,0.6984525557127008
21,T,2,RTT,1.5368061414675263
21,T,3,RTT,0.9319977009852062
22,R,1,RTT,-0.1368191567160466
22,T,2,RTT,-0.5771141008474387
22,T,3,RTT,0.49096197813623976
23,R,1,RTT,1.7887157911418317
23,T,2,RTT,2.005306651535501
23,T,3,RTT,2.381909032301739
24,R,1,RTT,0.8379089315459164
24,T,2,RTT,0.47144031121407326
24,T,3,RTT,1.2381277222603446
;
RUN;

PROC MIXED data=pkdata; 
CLASSES subject sequence period formulation;
MODEL  var = sequence period formulation/ DDFM=SATTERTH;
CONTRAST 'CONTR' formulation    1 -1; 
RANDOM  formulation/TYPE=CSH SUB=subject;
REPEATED/GRP=formulation SUB=subject;
ESTIMATE 'T vs. R' formulation 1 -1/CL ALPHA=0.1 E;
RUN;