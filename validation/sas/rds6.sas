DATA pkdata;
infile datalines dlm="," truncover;
input subject $ formulation $ period $sequence $ var;
datalines;
1,T,1,TRTR,1.1514444005797406
1,R,2,TRTR,2.0410980329257513
1,T,3,TRTR,1.4077081464879535
1,R,4,TRTR,2.210207731149509
2,T,1,TRTR,1.3200519065638596
2,R,2,TRTR,1.8144109464110678
2,T,3,TRTR,1.597115325499884
2,R,4,TRTR,2.2128080520598727
3,T,1,TRTR,0.7728222804679844
3,R,2,TRTR,2.2711111725510533
3,T,3,TRTR,1.048053278190787
3,R,4,TRTR,0.8113465762236374
4,T,1,TRTR,1.301587162594203
4,R,2,TRTR,1.2411724918185958
4,T,3,TRTR,2.272355671145646
4,R,4,TRTR,1.0216418998167214
5,T,1,TRTR,0.9457179289857146
5,R,2,TRTR,1.9005346543968809
5,T,3,TRTR,1.0566099983744297
5,R,4,TRTR,1.114016186031901
6,T,1,TRTR,1.2327360462281087
6,R,2,TRTR,1.9181112938987621
6,T,3,TRTR,1.5444070783875543
6,R,4,TRTR,1.2776808137963909
7,R,1,RTRT,1.0470098172297284
7,T,2,RTRT,0.6418628101511293
7,R,3,RTRT,0.3257070600163243
7,T,4,RTRT,-0.47714616357381856
8,R,1,RTRT,0.3891763068016213
8,T,2,RTRT,0.38693276524946696
8,R,3,RTRT,0.5492726197248483
8,T,4,RTRT,0.23273784161346744
9,R,1,RTRT,0.25403220974942786
9,T,2,RTRT,0.32020177797637484
9,R,3,RTRT,0.566068162111166
9,T,4,RTRT,0.5521041027400311
10,R,1,RTRT,-0.3158277603308468
10,T,2,RTRT,0.5855783141628654
10,R,3,RTRT,0.2638111957417332
10,T,4,RTRT,0.4974451071138064
11,R,1,RTRT,0.5538785884046917
11,T,2,RTRT,0.061598250128628185
11,R,3,RTRT,0.4943541988387018
11,T,4,RTRT,0.2216217098534592
12,R,1,RTRT,1.4214914162228023
12,T,2,RTRT,1.5646944404865892
12,R,3,RTRT,0.456907860812538
12,T,4,RTRT,1.7679807480352547
13,T,1,TTRR,0.5612446820999675
13,T,2,TTRR,0.8741789509841464
13,R,3,TTRR,0.882545468319072
13,R,4,TTRR,1.1605390343991362
14,T,1,TTRR,1.3105190832433693
14,T,2,TTRR,0.7498546453176058
14,R,3,TTRR,0.46755636369685316
14,R,4,TTRR,0.36127976345888
15,T,1,TTRR,1.0852627012142788
15,T,2,TTRR,0.41274012555918593
15,R,3,TTRR,1.0212461600184017
15,R,4,TTRR,1.0268587980192139
16,T,1,TTRR,0.5478679220132688
16,T,2,TTRR,1.0967589756737899
16,R,3,TTRR,1.9976594607881735
16,R,4,TTRR,1.5533803326444984
17,T,1,TTRR,0.6317035344047477
17,T,2,TTRR,0.6797102371180797
17,R,3,TTRR,0.31320698275054526
17,R,4,TTRR,1.297634663762802
18,T,1,TTRR,-0.5798360608552446
18,T,2,TTRR,-0.019454955949839148
18,R,3,TTRR,0.23820992274843356
18,R,4,TTRR,-0.8102979358571232
19,R,1,RRTT,1.4312676866101555
19,R,2,RRTT,0.8591158846759837
19,T,3,RRTT,0.7543398645314929
19,T,4,RRTT,1.0283723994628389
20,R,1,RRTT,1.9778925152268803
20,R,2,RRTT,1.3251707607728087
20,T,3,RRTT,1.124048032242209
20,T,4,RRTT,0.961062987810192
21,R,1,RRTT,-0.31149271708352533
21,R,2,RRTT,0.592645174998695
21,T,3,RRTT,1.1027082072183776
21,T,4,RRTT,0.9318369052792101
22,R,1,RRTT,2.0584132039042276
22,R,2,RRTT,1.912959952888373
22,T,3,RRTT,1.520069545960236
22,T,4,RRTT,1.6782520271613532
23,R,1,RRTT,0.9137529331742327
23,R,2,RRTT,0.7430944821812993
23,T,3,RRTT,0.4461676705533476
23,T,4,RRTT,0.32962727119872215
24,R,1,RRTT,1.2894578478942311
24,R,2,RRTT,1.5552829412330123
24,T,3,RRTT,2.3429492113913426
24,T,4,RRTT,1.924312091423097
;
RUN;

PROC MIXED data=pkdata; 
CLASSES subject sequence period formulation;
MODEL  var = sequence period formulation/ DDFM=SATTERTH;
CONTRAST 'CONTR' formulation    1 -1; 
RANDOM  formulation/TYPE=CSH SUB=subject;
REPEATED/GRP=formulation SUB=subject;
ESTIMATE 'T vs. R' formulation 1 -1/CL ALPHA=0.1 E;
RUN;